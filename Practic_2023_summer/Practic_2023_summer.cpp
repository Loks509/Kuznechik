#include "KuznShiphr.h"

unsigned char data_vec[] = {
    0x3a, 0x96, 0x09, 0x89, 0x10, 0x93, 0xa7, 0xb7, 
    0xb6, 0x33, 0x4a, 0xb0, 0x75, 0xc9, 0xca, 0xb1
};
unsigned char key_vec[] = {
    0xeb, 0x5d, 0x98, 0x02, 0x83, 0xab, 0x92, 0x57, 
    0x94, 0x55, 0x91, 0xb3, 0x18, 0x70, 0x6d, 0xb2,
    0x86, 0x52, 0x04, 0x22, 0x4f, 0xd8, 0x92, 0x4b, 
    0xf6, 0x78, 0x0d, 0xb6, 0x60, 0xbb, 0xe5, 0xe4
};

unsigned char key_gost[] = {
    0x77, 0x66, 0x55, 0x44, 0x33, 0x22, 0x11, 0x00, 
    0xFF, 0xEE, 0xDD, 0xCC, 0xBB, 0xAA, 0x99, 0x88,
    0xEF, 0xCD, 0xAB, 0x89, 0x67, 0x45, 0x23, 0x01, 
    0x10, 0x32, 0x54, 0x76, 0x98, 0xBA, 0xDC, 0xFE
};
unsigned char data_gost[] = {
    0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF, 
    0x00, 0x77, 0x66, 0x55, 0x44, 0x33, 0x22, 0x11 
};

void print_hex_vec(unsigned char *vec, int n) {
    for (size_t j = 0; j < n; j++)
        printf(" %x ", vec[j]);
    printf("\n");
}

int main(int argc, char* argv[])
{
    KuznShiphr t(key_vec);
    printf("Data: ");
    print_hex_vec(data_vec, 16);

    t.encode(data_vec);
    printf("Encoded data: ");
    print_hex_vec(data_vec, 16);

    t.decode(data_vec);
    printf("Decoded data: ");
    print_hex_vec(data_vec, 16);
}
