#include <iostream>
#include <bitset>
#include "KuznShiphr.h"

using namespace std;


unsigned char data[] = { 0xc5, 0xbd, 0xdf, 0xeb, 0x47, 0x1a, 0xff, 0xf9, 0x70, 0x74, 0x12, 0x07, 0x90, 0xc4, 0x89, 0xc0 };
unsigned char key[] = { 0xeb, 0x5d, 0x98, 0x02, 0x83, 0xab, 0x92, 0x57, 0x94, 0x55, 0x91, 0xb3, 0x18, 0x70, 0x6d, 0xb2,
						0x86, 0x52, 0x04, 0x22, 0x4f, 0xd8, 0x92, 0x4b, 0xf6, 0x78, 0x0d, 0xb6, 0x60, 0xbb, 0xe5, 0xe4 };

unsigned char key2[] = {
    0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff, 0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77,
    0xfe, 0xdc, 0xba, 0x98, 0x76, 0x54, 0x32, 0x10, 0x01, 0x23, 0x45, 0x67, 0x89, 0xAb, 0xCd, 0xEf
};
unsigned char data2[] = { 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x00, 0xff, 0xee, 0xdd, 0xcc, 0xbb, 0xaa, 0x99, 0x88 };

unsigned char key3[] = {
    0x77, 0x66, 0x55, 0x44, 0x33, 0x22, 0x11, 0x00, 0xFF, 0xEE, 0xDD, 0xCC, 0xBB, 0xAA, 0x99, 0x88,
    0xEF, 0xCD, 0xAB, 0x89, 0x67, 0x45, 0x23, 0x01, 0x10, 0x32, 0x54, 0x76, 0x98, 0xBA, 0xDC, 0xFE
};
unsigned char data3[] = { 0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF, 0x00, 0x77, 0x66, 0x55, 0x44, 0x33, 0x22, 0x11 };

void print_hex_vec(unsigned char *c, int n) {
    for (size_t j = 0; j < n; j++)
    {
        printf(" %x ", c[j]);
    }
    cout << endl;
}


int main(int argc, char* argv[])
{
    unsigned char c[32] = { 0 };
    KuznShiphr t(key3);
    for (size_t j = 0; j < 16; j++)
    {
        printf(" %x ", data3[j]);
    }
    cout << endl;
    t.encode(data3);
    
    //create_new_key_pair(key2, c);
    for (size_t j = 0; j < 16; j++)
    {
        printf(" %x ", data3[j]);
    }
    cout << endl;
    t.decode(data3);
    
    //create_new_key_pair(key2, c);
    for (size_t j = 0; j < 16; j++)
    {
        printf(" %x ", data3[j]);
    }
    cout << endl;
}
